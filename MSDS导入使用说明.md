# MSDS数据库Excel导入功能使用说明

## 📖 功能概述

MSDS数据库Excel导入功能允许你直接上传Excel格式的化学品安全技术说明书数据，系统会自动解析并导入到本地IndexedDB数据库中。

## 🚀 快速开始

### 1. 打开管理页面

- 方式一：直接访问 `msds-admin.html`
- 方式二：在首页点击"MSDS数据库"卡片中的"数据库管理"按钮

### 2. 导入Excel文件

**支持的文件格式：**
- `.xlsx` (推荐)
- `.xls`

**导入方式：**
- **点击上传**：点击上传区域，选择Excel文件
- **拖拽上传**：直接将Excel文件拖拽到上传区域

### 3. 系统自动处理

系统会自动：
1. 读取Excel文件中的所有工作表
2. 提取每个工作表中的化学品数据
3. 显示导入进度
4. 保存到浏览器本地数据库

### 4. 查看导入结果

导入完成后：
- 显示成功导入的化学品数量
- 数据列表自动更新
- 统计信息自动刷新

## 📋 Excel文件格式要求

### 你的Excel文件格式（已适配）

你当前的Excel文件格式：
```
- 文件包含35个工作表（Table 1 - Table 35）
- 每个工作表代表一个化学品
- 数据格式：第1列=字段名，第2列=字段值
```

**系统会自动识别以下字段：**
- 中文名称
- 英文名称
- 分子式
- 相对分子质量
- CAS号
- UN号
- 危规号
- 外观与性状
- 溶解性
- 熔点、沸点
- 闪点
- 爆炸限
- 引燃温度
- 危险特性
- 灭火方法
- 接触限值
- 健康危害
- 急救措施
- 防护措施
- 泄漏处理
- 储运特性

## ✅ 成功导入的条件

只要工作表中包含**中文名称**字段，系统就会将其识别为有效数据并导入。

## 🔍 导入后的功能

### 1. 搜索功能
- 支持中文名称搜索
- 支持英文名称搜索
- 支持CAS号搜索
- 支持UN号搜索

### 2. 数据管理
- 查看化学品详细信息
- 删除单条数据
- 清空整个数据库

### 3. 分页浏览
- 每页显示20条数据
- 支持翻页查看

## 📊 数据存储说明

### 存储位置
- 数据存储在浏览器的IndexedDB中
- 数据库名称：`ChemicalSafetyDB`
- 数据表名称：`chemicals`

### 数据特点
- ✅ 本地存储，无需网络
- ✅ 数据持久化，关闭浏览器后仍然保留
- ✅ 数据私密，仅存储在你的电脑上
- ⚠️ 清除浏览器数据会删除数据库

## 🔄 分批导入

你可以多次导入Excel文件，系统会累加数据：

1. **第一批**：导入 001-040.xlsx → 35条数据
2. **第二批**：导入 041-080.xlsx → 累计70条数据
3. **第三批**：导入 081-120.xlsx → 累计105条数据
4. ...以此类推

## 💡 使用建议

### 建议1：分批整理和导入
- 每次整理20-40个化学品
- 整理完一批就导入一批
- 逐步建立完整的数据库

### 建议2：定期备份
虽然数据存储在本地很安全，但建议：
- 定期将Excel源文件备份
- 重要数据建议保存多份

### 建议3：数据验证
导入后建议：
- 搜索几个常用化学品
- 检查数据是否完整
- 确认信息准确性

## 🆘 常见问题

### Q1: 导入后看不到数据？
**A:** 检查Excel文件中是否包含"中文名称"字段，这是必须字段。

### Q2: 导入显示0条数据？
**A:**
- 检查Excel工作表结构是否正确
- 确认第1列是字段名，第2列是字段值
- 查看浏览器控制台是否有错误信息

### Q3: 如何重新导入数据？
**A:**
1. 点击"清空数据库"按钮
2. 重新上传Excel文件

### Q4: 数据能否导出？
**A:** 当前版本暂不支持导出，建议保留原始Excel文件。

## 📱 浏览器兼容性

推荐使用以下浏览器：
- ✅ Chrome 50+
- ✅ Firefox 45+
- ✅ Edge 79+
- ✅ Safari 11+

## 🎯 下一步计划

后续版本将支持：
- [ ] 数据导出功能
- [ ] 批量编辑
- [ ] 数据备份和恢复
- [ ] 高级搜索和筛选
- [ ] 数据统计和分析

---

**如有问题，请查看浏览器控制台的错误信息，或联系技术支持。**
